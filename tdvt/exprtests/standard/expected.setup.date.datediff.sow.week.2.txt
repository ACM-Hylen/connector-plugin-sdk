<results>
  <test name='DATEDIFF(&apos;week&apos;, [date3], [date2], &apos;monday&apos;)'>
    <sql>
      SELECT DATE_DIFF(CAST(TIMESTAMP_ADD(CAST(DATE_ADD(CAST(CAST(DATE_TRUNC(CAST(`date2` AS DATE), DAY) AS TIMESTAMP) AS DATE), INTERVAL (-1 * MOD((7 + EXTRACT(DAYOFWEEK FROM `date2`) - 2),7)) DAY) AS TIMESTAMP), INTERVAL TIMESTAMP_DIFF(CAST(CAST(DATE_TRUNC(CAST(`date2` AS DATE), DAY) AS TIMESTAMP) AS TIMESTAMP),CAST(CAST(CAST(DATE_TRUNC(CAST(`date2` AS DATE), DAY) AS TIMESTAMP) AS DATE) AS TIMESTAMP), SECOND) SECOND) AS DATE), CAST(TIMESTAMP_ADD(CAST(DATE_ADD(CAST(CAST(DATE_TRUNC(CAST(`date3` AS DATE), DAY) AS TIMESTAMP) AS DATE), INTERVAL (-1 * MOD((7 + EXTRACT(DAYOFWEEK FROM `date3`) - 2),7)) DAY) AS TIMESTAMP), INTERVAL TIMESTAMP_DIFF(CAST(CAST(DATE_TRUNC(CAST(`date3` AS DATE), DAY) AS TIMESTAMP) AS TIMESTAMP),CAST(CAST(CAST(DATE_TRUNC(CAST(`date3` AS DATE), DAY) AS TIMESTAMP) AS DATE) AS TIMESTAMP), SECOND) SECOND) AS DATE), DAY) / 7 AS `TEMP_Test__3550551924__0_`&#10;FROM `tactile-pulsar-824.TestV1`.`CalcsDates` `CalcsDates`&#10;GROUP BY 1
    </sql>
    <query-time>
      810.000
    </query-time>
    <table>
      <schema>
        <column>[cast_calcs.bigquery_sql_dates].[TEMP(Test)(3550551924)(0)]</column>
      </schema>
      <tuple>
        <value>%null%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
    </table>
  </test>
  <test name='DATEDIFF(&apos;week&apos;, [date3], [date2], &apos;sunday&apos;)'>
    <sql>
      SELECT  CAST(( (FLOOR(UNIX_SECONDS(CAST(`date2` AS TIMESTAMP)) / 86400) - EXTRACT(DAYOFWEEK FROM `date2`) ) - (FLOOR(UNIX_SECONDS(CAST(`date3` AS TIMESTAMP)) / 86400) - EXTRACT(DAYOFWEEK FROM `date3`) ) ) / 7 AS INT64) AS `TEMP_Test__2745903531__0_`&#10;FROM `tactile-pulsar-824.TestV1`.`CalcsDates` `CalcsDates`&#10;GROUP BY 1
    </sql>
    <query-time>
      628.000
    </query-time>
    <table>
      <schema>
        <column>[cast_calcs.bigquery_sql_dates].[TEMP(Test)(2745903531)(0)]</column>
      </schema>
      <tuple>
        <value>%null%</value>
      </tuple>
      <tuple>
        <value>-1326</value>
      </tuple>
      <tuple>
        <value>-747</value>
      </tuple>
      <tuple>
        <value>-465</value>
      </tuple>
      <tuple>
        <value>-436</value>
      </tuple>
      <tuple>
        <value>-350</value>
      </tuple>
      <tuple>
        <value>32</value>
      </tuple>
      <tuple>
        <value>64</value>
      </tuple>
      <tuple>
        <value>83</value>
      </tuple>
      <tuple>
        <value>536</value>
      </tuple>
    </table>
  </test>
  <test name='DATEDIFF(&apos;week&apos;, DATETIME([date2]), [datetime0], &apos;monday&apos;)'>
    <sql>
      SELECT DATE_DIFF(CAST(TIMESTAMP_ADD(CAST(DATE_ADD(CAST(CAST(DATE_TRUNC(CAST(`datetime0` AS DATE), DAY) AS TIMESTAMP) AS DATE), INTERVAL (-1 * MOD((7 + EXTRACT(DAYOFWEEK FROM `datetime0`) - 2),7)) DAY) AS TIMESTAMP), INTERVAL TIMESTAMP_DIFF(CAST(CAST(DATE_TRUNC(CAST(`datetime0` AS DATE), DAY) AS TIMESTAMP) AS TIMESTAMP),CAST(CAST(CAST(DATE_TRUNC(CAST(`datetime0` AS DATE), DAY) AS TIMESTAMP) AS DATE) AS TIMESTAMP), SECOND) SECOND) AS DATE), CAST(TIMESTAMP_ADD(CAST(DATE_ADD(CAST(CAST(DATE_TRUNC(CAST(`date2` AS DATE), DAY) AS TIMESTAMP) AS DATE), INTERVAL (-1 * MOD((7 + EXTRACT(DAYOFWEEK FROM `date2`) - 2),7)) DAY) AS TIMESTAMP), INTERVAL TIMESTAMP_DIFF(CAST(CAST(DATE_TRUNC(CAST(`date2` AS DATE), DAY) AS TIMESTAMP) AS TIMESTAMP),CAST(CAST(CAST(DATE_TRUNC(CAST(`date2` AS DATE), DAY) AS TIMESTAMP) AS DATE) AS TIMESTAMP), SECOND) SECOND) AS DATE), DAY) / 7 AS `TEMP_Test__1341534691__0_`&#10;FROM `tactile-pulsar-824.TestV1`.`CalcsDates` `CalcsDates`&#10;GROUP BY 1
    </sql>
    <query-time>
      735.000
    </query-time>
    <table>
      <schema>
        <column>[cast_calcs.bigquery_sql_dates].[TEMP(Test)(1341534691)(0)]</column>
      </schema>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
      <tuple>
        <value>%error%</value>
      </tuple>
    </table>
  </test>
  <test name='DATEDIFF(&apos;week&apos;, DATETIME([date2]), [datetime0], &apos;sunday&apos;)'>
    <sql>
      SELECT  CAST(( (FLOOR(UNIX_SECONDS(CAST(`datetime0` AS TIMESTAMP)) / 86400) - EXTRACT(DAYOFWEEK FROM `datetime0`) ) - (FLOOR(UNIX_SECONDS(CAST(`date2` AS TIMESTAMP)) / 86400) - EXTRACT(DAYOFWEEK FROM `date2`) ) ) / 7 AS INT64) AS `TEMP_Test__1157868287__0_`&#10;FROM `tactile-pulsar-824.TestV1`.`CalcsDates` `CalcsDates`&#10;GROUP BY 1
    </sql>
    <query-time>
      719.000
    </query-time>
    <table>
      <schema>
        <column>[cast_calcs.bigquery_sql_dates].[TEMP(Test)(1157868287)(0)]</column>
      </schema>
      <tuple>
        <value>118</value>
      </tuple>
      <tuple>
        <value>179</value>
      </tuple>
      <tuple>
        <value>310</value>
      </tuple>
      <tuple>
        <value>359</value>
      </tuple>
      <tuple>
        <value>374</value>
      </tuple>
      <tuple>
        <value>464</value>
      </tuple>
      <tuple>
        <value>475</value>
      </tuple>
      <tuple>
        <value>536</value>
      </tuple>
      <tuple>
        <value>863</value>
      </tuple>
      <tuple>
        <value>1237</value>
      </tuple>
      <tuple>
        <value>1250</value>
      </tuple>
      <tuple>
        <value>1420</value>
      </tuple>
      <tuple>
        <value>1433</value>
      </tuple>
      <tuple>
        <value>1452</value>
      </tuple>
      <tuple>
        <value>1576</value>
      </tuple>
      <tuple>
        <value>1582</value>
      </tuple>
      <tuple>
        <value>1672</value>
      </tuple>
    </table>
  </test>
</results>
