<results>
  <test name='HEXBINX([int2],2)'>
    <sql>
      SELECT (((CASE WHEN (ABS((2) - (CAST( ( (2) / SQRT(3.0) ) AS NUMERIC(18, 0) ) * SQRT(3.0)))) + SQRT(3.0) * ((ABS((&quot;Calcs&quot;.&quot;int2&quot;) - (CAST( ( (&quot;Calcs&quot;.&quot;int2&quot;) / 3.0 ) AS NUMERIC(18, 0) ) * 3.0))) - 1.0) &gt; 0.0 THEN 1.5 ELSE 0.0 END) - (CASE WHEN ((&quot;Calcs&quot;.&quot;int2&quot;) - (CAST( ( (&quot;Calcs&quot;.&quot;int2&quot;) / 3.0 ) AS NUMERIC(18, 0) ) * 3.0) &lt; 0.0) AND ((CASE WHEN (ABS((2) - (CAST( ( (2) / SQRT(3.0) ) AS NUMERIC(18, 0) ) * SQRT(3.0)))) + SQRT(3.0) * ((ABS((&quot;Calcs&quot;.&quot;int2&quot;) - (CAST( ( (&quot;Calcs&quot;.&quot;int2&quot;) / 3.0 ) AS NUMERIC(18, 0) ) * 3.0))) - 1.0) &gt; 0.0 THEN 1.5 ELSE 0.0 END) &gt; 0.0) THEN 3.0 ELSE 0.0 END)) + (CAST( ( (&quot;Calcs&quot;.&quot;int2&quot;) / 3.0 ) AS NUMERIC(18, 0) ) * 3.0)) AS &quot;TEMP(Test)(2503102272)(0)&quot;&#10;FROM &quot;Calcs&quot;&#10;GROUP BY 1
    </sql>
    <table>
      <schema>
        <column>[cast_calcs.postgres91].[TEMP(Test)(2503102272)(0)]</column>
      </schema>
      <tuple>
        <value>-9.0</value>
      </tuple>
      <tuple>
        <value>-7.5</value>
      </tuple>
      <tuple>
        <value>-6.0</value>
      </tuple>
      <tuple>
        <value>-4.5</value>
      </tuple>
      <tuple>
        <value>-3.0</value>
      </tuple>
      <tuple>
        <value>0.0</value>
      </tuple>
      <tuple>
        <value>1.5</value>
      </tuple>
      <tuple>
        <value>3.0</value>
      </tuple>
      <tuple>
        <value>4.5</value>
      </tuple>
      <tuple>
        <value>6.0</value>
      </tuple>
      <tuple>
        <value>9.0</value>
      </tuple>
    </table>
  </test>
  <test name='HEXBINY([int2],2)'>
    <sql>
      SELECT CAST( (((CASE WHEN (ABS((2) - (CAST( ( (2) / SQRT(3.0) ) AS NUMERIC(18, 0) ) * SQRT(3.0)))) + SQRT(3.0) * ((ABS((&quot;Calcs&quot;.&quot;int2&quot;) - (CAST( ( (&quot;Calcs&quot;.&quot;int2&quot;) / 3.0 ) AS NUMERIC(18, 0) ) * 3.0))) - 1.0) &gt; 0.0 THEN SQRT(3.0) / 2.0 ELSE 0.0 END) - (CASE WHEN ((2) - (CAST( ( (2) / SQRT(3.0) ) AS NUMERIC(18, 0) ) * SQRT(3.0)) &lt; 0.0) AND ((CASE WHEN (ABS((2) - (CAST( ( (2) / SQRT(3.0) ) AS NUMERIC(18, 0) ) * SQRT(3.0)))) + SQRT(3.0) * ((ABS((&quot;Calcs&quot;.&quot;int2&quot;) - (CAST( ( (&quot;Calcs&quot;.&quot;int2&quot;) / 3.0 ) AS NUMERIC(18, 0) ) * 3.0))) - 1.0) &gt; 0.0 THEN SQRT(3.0) / 2.0 ELSE 0.0 END) &gt; 0.0) THEN SQRT(3.0) ELSE 0.0 END)) + (CAST( ( (2) / SQRT(3.0) ) AS NUMERIC(18, 0) ) * SQRT(3.0))) AS NUMERIC(18,3) ) AS &quot;TEMP(Test)(2977666156)(0)&quot;&#10;FROM &quot;Calcs&quot;&#10;GROUP BY 1
    </sql>
    <table>
      <schema>
        <column>[cast_calcs.postgres91].[TEMP(Test)(2977666156)(0)]</column>
      </schema>
      <tuple>
        <value>1.732</value>
      </tuple>
      <tuple>
        <value>2.598</value>
      </tuple>
    </table>
  </test>
</results>
