<?xml version='1.0' encoding='utf-8' ?>

<results>
  <test name='E:\dev\data-dev2\tableau-tests\tdvt\logicaltests\setup\lod\setup.lod.16_As Group.prefix.xml'>
    <sql>
      SELECT &quot;t1&quot;.&quot;lod___fixed___4__group_&quot; AS &quot;lod___fixed___4__group_&quot;,&#10;  &quot;t6&quot;.&quot;x_measure__3&quot; AS &quot;avg_calculation_4821225012418421_ok&quot;,&#10;  &quot;t1&quot;.&quot;avg_price_ok&quot; AS &quot;avg_price_ok&quot;,&#10;  &quot;t11&quot;.&quot;x_measure__6&quot; AS &quot;sum_calculation_4621225004123988_ok&quot;&#10;FROM (&#10;  SELECT (CASE WHEN (DATEDIFF(MONTH, &quot;t0&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (0, 1, 2, 3, 4, 5, 6)) THEN 0 WHEN (DATEDIFF(MONTH, &quot;t0&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64)) THEN 16 WHEN (DATEDIFF(MONTH, &quot;t0&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (10, 11, 12, 13, 14, 15, 7, 8, 9)) THEN 7 ELSE 71 END) AS &quot;lod___fixed___4__group_&quot;,&#10;    AVG(&quot;Staples&quot;.&quot;Price&quot;) AS &quot;avg_price_ok&quot;&#10;  FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;    CROSS JOIN (&#10;    SELECT MIN(&quot;Staples&quot;.&quot;Order Date&quot;) AS &quot;x_measure__0&quot;&#10;    FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;    HAVING (COUNT(1) &gt; 0)&#10;  ) &quot;t0&quot;&#10;  GROUP BY 1&#10;) &quot;t1&quot;&#10;  INNER JOIN (&#10;  SELECT &quot;t3&quot;.&quot;lod___fixed___4__group_&quot; AS &quot;lod___fixed___4__group_&quot;,&#10;    CAST(MIN(&quot;t5&quot;.&quot;x_measure__2&quot;) AS FLOAT) AS &quot;x_measure__3&quot;&#10;  FROM (&#10;    SELECT DATEPART(&apos;MONTH&apos;, &quot;t2&quot;.&quot;x_measure__1&quot;) AS &quot;calculation_8741225012317469&quot;,&#10;      (CASE WHEN (DATEDIFF(MONTH, &quot;t2&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (0, 1, 2, 3, 4, 5, 6)) THEN 0 WHEN (DATEDIFF(MONTH, &quot;t2&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64)) THEN 16 WHEN (DATEDIFF(MONTH, &quot;t2&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (10, 11, 12, 13, 14, 15, 7, 8, 9)) THEN 7 ELSE 71 END) AS &quot;lod___fixed___4__group_&quot;&#10;    FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;      CROSS JOIN (&#10;      SELECT MIN(&quot;Staples&quot;.&quot;Order Date&quot;) AS &quot;x_measure__1&quot;,&#10;        MIN(&quot;Staples&quot;.&quot;Order Date&quot;) AS &quot;x_measure__0&quot;&#10;      FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;      HAVING (COUNT(1) &gt; 0)&#10;    ) &quot;t2&quot;&#10;    GROUP BY 1,&#10;      2&#10;  ) &quot;t3&quot;&#10;    INNER JOIN (&#10;    SELECT DATEPART(&apos;MONTH&apos;, &quot;t4&quot;.&quot;x_measure__1&quot;) AS &quot;calculation_8741225012317469&quot;,&#10;      SUM(&quot;Staples&quot;.&quot;Order Quantity&quot;) AS &quot;x_measure__2&quot;&#10;    FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;      CROSS JOIN (&#10;      SELECT MIN(&quot;Staples&quot;.&quot;Order Date&quot;) AS &quot;x_measure__1&quot;&#10;      FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;      HAVING (COUNT(1) &gt; 0)&#10;    ) &quot;t4&quot;&#10;    GROUP BY 1&#10;  ) &quot;t5&quot; ON ((&quot;t3&quot;.&quot;calculation_8741225012317469&quot; = &quot;t5&quot;.&quot;calculation_8741225012317469&quot;) OR ((&quot;t3&quot;.&quot;calculation_8741225012317469&quot; IS NULL) AND (&quot;t5&quot;.&quot;calculation_8741225012317469&quot; IS NULL)))&#10;  GROUP BY 1&#10;) &quot;t6&quot; ON (&quot;t1&quot;.&quot;lod___fixed___4__group_&quot; = &quot;t6&quot;.&quot;lod___fixed___4__group_&quot;)&#10;  INNER JOIN (&#10;  SELECT &quot;t8&quot;.&quot;lod___fixed___4__group_&quot; AS &quot;lod___fixed___4__group_&quot;,&#10;    SUM(&quot;t10&quot;.&quot;x_measure__5&quot;) AS &quot;x_measure__6&quot;&#10;  FROM (&#10;    SELECT (CASE WHEN (DATEDIFF(MONTH, &quot;t7&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (0, 1, 2, 3, 4, 5, 6)) THEN 0 WHEN (DATEDIFF(MONTH, &quot;t7&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64)) THEN 16 WHEN (DATEDIFF(MONTH, &quot;t7&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (10, 11, 12, 13, 14, 15, 7, 8, 9)) THEN 7 ELSE 71 END) AS &quot;lod___fixed___4__group_&quot;,&#10;      &quot;Staples&quot;.&quot;Prod Type1&quot; AS &quot;prod_type1&quot;&#10;    FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;      CROSS JOIN (&#10;      SELECT MIN(&quot;Staples&quot;.&quot;Order Date&quot;) AS &quot;x_measure__0&quot;&#10;      FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;      HAVING (COUNT(1) &gt; 0)&#10;    ) &quot;t7&quot;&#10;    GROUP BY 1,&#10;      2&#10;  ) &quot;t8&quot;&#10;    INNER JOIN (&#10;    SELECT (CASE WHEN (DATEDIFF(MONTH, &quot;t9&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (0, 1, 2, 3, 4, 5, 6)) THEN 0 WHEN (DATEDIFF(MONTH, &quot;t9&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64)) THEN 16 WHEN (DATEDIFF(MONTH, &quot;t9&quot;.&quot;x_measure__0&quot;, &quot;Staples&quot;.&quot;Order Date&quot;) IN (10, 11, 12, 13, 14, 15, 7, 8, 9)) THEN 7 ELSE 71 END) AS &quot;lod___fixed___4__group_&quot;,&#10;      &quot;Staples&quot;.&quot;Prod Type1&quot; AS &quot;prod_type1&quot;,&#10;      SUM(&quot;Staples&quot;.&quot;Sales Total&quot;) AS &quot;x_measure__5&quot;&#10;    FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;      CROSS JOIN (&#10;      SELECT MIN(&quot;Staples&quot;.&quot;Order Date&quot;) AS &quot;x_measure__0&quot;&#10;      FROM &quot;TestV1&quot;.&quot;Staples&quot; &quot;Staples&quot;&#10;      HAVING (COUNT(1) &gt; 0)&#10;    ) &quot;t9&quot;&#10;    GROUP BY 1,&#10;      2&#10;  ) &quot;t10&quot; ON ((&quot;t8&quot;.&quot;lod___fixed___4__group_&quot; = &quot;t10&quot;.&quot;lod___fixed___4__group_&quot;) AND ((&quot;t8&quot;.&quot;prod_type1&quot; = &quot;t10&quot;.&quot;prod_type1&quot;) OR ((&quot;t8&quot;.&quot;prod_type1&quot; IS NULL) AND (&quot;t10&quot;.&quot;prod_type1&quot; IS NULL))))&#10;  GROUP BY 1&#10;) &quot;t11&quot; ON (&quot;t1&quot;.&quot;lod___fixed___4__group_&quot; = &quot;t11&quot;.&quot;lod___fixed___4__group_&quot;)
    </sql>
    <query-time>
      1395.000
    </query-time>
    <table>
      <schema>
        <column>[Staples.paraccel].[LOD - Fixed - 4 (group)]</column>
        <column>[Staples.paraccel].[avg:Calculation_4821225012418421:ok]</column>
        <column>[Staples.paraccel].[avg:Price:ok]</column>
        <column>[Staples.paraccel].[sum:Calculation_4621225004123988:ok]</column>
      </schema>
      <tuple>
        <value>0</value>
        <value>1390980.0</value>
        <value>83.3768</value>
        <value>9334296.5</value>
      </tuple>
      <tuple>
        <value>7</value>
        <value>1390980.0</value>
        <value>90.5006</value>
        <value>12192129.0</value>
      </tuple>
      <tuple>
        <value>16</value>
        <value>1390980.0</value>
        <value>85.6796</value>
        <value>67941185.0</value>
      </tuple>
      <tuple>
        <value>71</value>
        <value>1390980.0</value>
        <value>82.7646</value>
        <value>9220327.3</value>
      </tuple>
    </table>
  </test>
</results>
